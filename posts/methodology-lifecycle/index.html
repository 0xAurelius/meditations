<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marcus Aurelius">
<meta name="dcterms.date" content="2023-08-09">

<title>Marcus Aurelius - Methodology Lifecycle Governance for Environmental Assets</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../pfp.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Marcus Aurelius - Methodology Lifecycle Governance for Environmental Assets">
<meta property="og:description" content="">
<meta property="og:image" content="https://www.marcus.limo/posts/methodology-lifecycle/landscape.jpg">
<meta property="og:site-name" content="Marcus Aurelius | Meditations">
<meta name="twitter:title" content="Marcus Aurelius - Methodology Lifecycle Governance for Environmental Assets">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://www.marcus.limo/posts/methodology-lifecycle/landscape.jpg">
<meta name="twitter:creator" content="@0xKlimaurelius">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Marcus Aurelius</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Meditations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../speaking.html" rel="" target="">
 <span class="menu-text">Speaking</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/0xAurelius" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/0xKlimaurelius" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:marcus_aurelius_0x@proton.me" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Methodology Lifecycle Governance for Environmental Assets</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">governance</div>
                <div class="quarto-category">klimadao</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Marcus Aurelius </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 9, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Carbon credits quantify the greenhouse gas (GHG) emission reductions or removals achieved by projects or programs around the world that mitigate climate change. Carbon credit standards set rules and requirements to ensure the quality and integrity of these credits. Standards provide methodologies for measuring, monitoring and verifying the GHG benefits of different types of activities, such as renewable energy, forest conservation, or waste management.</p>
<p>In this post, I explore how existing carbon credit standards develop and maintain methodologies, as well as how decentralized governance mechanisms can facilitate destruction of credits from deprecated methodologies - leading to a more robust carbon market, better equipped to adapt to evolving scientific consensus.</p>
<section id="what-is-a-methodology-anyway" class="level1">
<h1>What is a Methodology Anyway?</h1>
<p>Much like a lab experiment you might have done in grade-school science class, a methodology specifies a detailed set of steps and procedures to reproduce a particular result.</p>
<p>A carbon credit methodology will typically specify: - the <strong>applicability conditions</strong> under which the activity should take place - how to define the <strong>boundaries</strong> of a project - how to construct an appropriate <strong>baseline</strong> (i.e.&nbsp;demonstrate that the project activities actually make a difference relative to the status quo) - how to <strong>quantify the greenhouse gas emissions</strong> avoided or removed by the activity - how to <strong>monitor</strong> the project to ensure the intended results are realized</p>
</section>
<section id="status-quo-methodology-development" class="level1">
<h1>Status Quo Methodology Development</h1>
<p>The first verified carbon credit system, the <a href="https://unfccc.int/process-and-meetings/the-kyoto-protocol/mechanisms-under-the-kyoto-protocol/the-clean-development-mechanism">Clean Development Mechanism</a>, was created 30 years ago under the Kyoto Protocol. Since then, the governance mechanisms for carbon credit standards have not changed much. In particular, they tend to favor opaque submission and review processes where most activities are carried out by permissioned insiders (e.g.&nbsp;staff at the standards body). While standards typically feature a public comment period in their methodology development process, the submitted comments are not published in full, and it is difficult to tell if issues that were raised have been properly addressed.</p>
<section id="example-verras-verified-carbon-standard-vcs" class="level2">
<h2 class="anchored" data-anchor-id="example-verras-verified-carbon-standard-vcs">Example: Verra’s Verified Carbon Standard (VCS)</h2>
<p><a href="https://verra.org/">Verra</a> is a non-profit organization that manages several standards and programs for climate action and sustainable development, including the VCS Program, which is the world’s most widely used GHG crediting program. The VCS Program has issued over one billion carbon credits from thousands of projects in 80 countries.</p>
<p>The VCS Program has its own methodologies that have been approved for use by Verra, as well as methodologies from other approved GHG programs, such as the Clean Development Mechanism (CDM) and the Climate Action Reserve (CAR). All methodologies undergo a <a href="https://verra.org/methodologies-main/develop-a-methodology/">review and consultation process</a> to ensure they meet the rules and requirements of the VCS Program.</p>
<p>Verra periodically reviews VCS methodologies to ensure they continue to reflect best practices, scientific consensus, and evolving market conditions and technical developments in a sector.</p>
<p>However, there is no standardized mechanism in the methodology governance process for deprecating an approved methodology if/when it reaches end-of-life - though, as we’ll see, several methodologies have been “phased out” ad hoc over the years.</p>
</section>
</section>
<section id="cleaning-up-a-decade-old-mess" class="level1">
<h1>Cleaning Up a Decade-Old Mess</h1>
<p>During the joint launch of <a href="https://docs.toucan.earth/toucan/bridge/carbon-bridge">Toucan’s one-way carbon bridge</a> and <a href="https://klimadao.finance">KlimaDAO</a>, about 700,000 tonnes of carbon credits were bridged from the Verra registry issued under the AM0001 methodology for decomposition of HFC-23 (a byproduct from production of refrigerant).</p>
<p>This particular <a href="https://cdm.unfccc.int/methodologies/DB/GAOZAY2DWIQHK71LJS027N6N4AV6SC">methodology was originally developed under the CDM</a>, and was carried forward into Verra’s VCS. However, in the wake of the Montreal Protocol, which established mandatory commitments at the national level for preventing emissions of hydroflourocarbons like HFC-23, Verra subsequently <a href="https://verra.org/phasing-out-hfc-23-projects/">ceased issuance of credits under any methodology related to HFC-23</a>.</p>
<p>The HFC-23 methodology was also called into question because of concerns that some project developers were <a href="https://carbonbetter.com/story/additionality/">producing more refrigerant than they actually had buyers for, simply to issue carbon credits based on the decomposition of the HFC-23 byproduct</a>.</p>
<p>After the methodology was discontinued by Verra, no steps were taken to address the millions of tonnes of credits which were issued under this methodology and remained on the books of many carbon market participants. This created ambiguity around the value of these assets, and led many in the carbon markets to conveniently forget about their existence. Nonetheless, for years after the deprecation of the methodology, transactions and retirements continued in the shadows of the over-the-counter (OTC) market.</p>
<section id="leveraging-public-governance" class="level2">
<h2 class="anchored" data-anchor-id="leveraging-public-governance">Leveraging Public Governance</h2>
<p>This is a clear coordination failure: no new credits would be issued under the methodology, yet there was no mechanism to signal that the market had moved on from the existing credits and destroy them once and for all to prevent further use.</p>
<p>Of course, Verra did not originate this methodology - it was originally developed under the CDM - but it did continue to allow retirement of these credits after ceasing issuance. Under its current Terms of Use, Verra lacks the ability to unilaterally destroy properly issued credits held by registry users, and registry users have no incentive to destroy their own assets.</p>
<p>As the situation became clear to the KlimaDAO community, Toucan implemented a restriction on the BCT pool to prevent more HFC-23 credits from being added to the pool. However, just like the off-chain market, the Digital Carbon Market had now inherited a significant chunk of these credits.</p>
</section>
<section id="sorting-the-laundry" class="level2">
<h2 class="anchored" data-anchor-id="sorting-the-laundry">Sorting the Laundry</h2>
<p>Seeing this as an opportunity to exercise the unique advantages of KlimaDAO’s public governance mechanism, I helped conduct an investigation into the history and activity of these credits.</p>
<p>On one hand, <a href="https://www.rff.org/publications/working-papers/the-net-emissions-impact-of-hfc-23-offset-projects-from-the-clean-development-mechanism/">academic research</a> indicated that some HFC-23 decomposition projects had been properly implemented, potentially even under-crediting - while other projects had engaged in deliberate over-creditng by producing more refrigerant than they would under a Business-As-Usual (BAU) scenario.</p>
<p>However, based on the Verra <a href="https://registry.verra.org/app/search/VCS/VCUs">public registry data</a> on retirements, I found that credits from I found that this methodology had not been used for retirement in about 2 years.</p>
<p>As such, the path forward was clear to me: even if the particular project whose credits ended up in the KlimaDAO treasury were from a project that did not abuse the system, and issued at a time when the methodology was still actively used for retirement, those credits were objectively no longer being used, and therefore did not warrant going inclusion in the digital carbon market.</p>
<p>So I began to prepare a <a href="https://forum.klimadao.finance/d/115-kip-26a-hfc-23-cleanup-operation-with-additional-background">governance proposal</a> which would destroy all of the HFC-23 credits in the BCT pool. I also approached Toucan for assistance in the process, both in terms of capital to destroy the credits and a special function to allow burning of credits from the pool without paying the selective redemption fee.</p>
<p>Several weeks later, <a href="https://snapshot.org/#/klimadao.eth/proposal/0x2ae3fce131f98bf22ec9ef306a13e359002eaea0d111328149204dfd9dc9b2e4">KLIMA token holders voted definitively to destroy the HFC-23 credits</a>.</p>
</section>
</section>
<section id="murphys-law-for-methodologies" class="level1">
<h1>Murphy’s Law for Methodologies</h1>
<p>Based on this experience I propose a corollary of <a href="https://en.wikipedia.org/wiki/Murphy's_law">Murphy’s Law</a> for carbon credit methodologies:</p>
<blockquote class="blockquote">
<p>No methodology is perfect - therefore all methodologies will be criticized.</p>
</blockquote>
<p>Criticism and scrutiny is absolutely essential to progress this market and develop the most effective and impactful methodologies. But when that data-driven, scientific criticism is wrapped up into an overly simplistic narrative and shouted from the rootops, it can disrupt the market.</p>
<p>Rather than abandoning a methodology wholesale based on simplistic narratives, the carbon market needs mechanisms to deliberately evolve over time. The goal should be to avoid disrupting project developers midflight, and prevent an inefficient race to the top of the price curve, which distorts the relationship between price, cost and efficiency.</p>
<p>KlimaDAO established a precedent to maintain support for a given methodology until market participants have not utilized that asset for retirement purposes in years. As new supply comes online and KlimaDAO integrates that supply into its ecosystem and treasury, the HFC-23 situation provides an example of progressively improving the carbon markets using public governance.</p>
</section>
<section id="reflecting-on-the-hfc-23-situation" class="level1">
<h1>Reflecting on the HFC-23 situation</h1>
<p>In a perfect world, could the KlimaDAO and Toucan teams have known about the HFC-23 credits and designed the BCT pool criteria to prevent them from entering in the first place? Sure. But would this have prevented criticism of other methodologies? Certainly not.</p>
<p>Whether the methodology is HFC-23 decomposition or renewable energy based credits, REDD+ avoided deforestation or improved cookstoves, all methodologies should and will be subject to criticism so they can improve over time. This is a feature of the open, public nature of environmental assets - not a bug.</p>
<p>However, there is a bug in our social infrastructure: careful, data-driven scientific criticism is undermined by academia’s “publish or perish” incentive structure, leading to click-baity journal titles like <a href="https://www.researchgate.net/publication/368760959_Cooking_the_books_Pervasive_over-crediting_from_cookstoves_offset_methodologies">“Cooking the books”</a>. These articles are then blindly picked up by media outlets, which have an incentive to generate impressions rather than foster nuanced understanding.</p>
<p>In this case of this cookstoves article, the authors misleadingly emphasize the overcrediting associated with the oldest CDM cookstove methodology, which very few new projects are deploying, while their detailed analysis indicates that some of the new cookstove methodologies may actually be issuing <em>fewer</em> credits than tonnes of carbon dioxide actually avoided. Instead of emphasizing that methodologies in this high-impact sector have gradually improved over time, the authors emphasize problems with the oldest version of this methodology.</p>
<p>This dynamic places project developers, the people on the ground doing the work, in a very precarious position: raising capital to take on a multi-year project, while having to constantly worry that the next media takedown will be about the methodology they have adopted. It also leads to hesitation among the end users who retire carbon credits, since they can never be sure when the projects they choose to support will be called into question.</p>
<p>This counterproductive dynamic is a problem of incentive alignment. Public governance mechanisms for environmental markets, such as that pioneered by KlimaDAO in the Digital Carbon Market, can align the incentives of diverse market actors. There is an opportunity to build more robust mechanisms for governing the lifecyle of methodologies, which will ensure the market can move on from particular methodologies through a more deliberate and decisive process.</p>
</section>
<section id="signs-of-life" class="level1">
<h1>Signs of Life</h1>
<p>As evidence of the need for an end-of-life governance mechanism, several <a href="https://www.qcintel.com/carbon/article/us-hfc-and-southeast-asian-redd-credits-trade-15918.html">transactions of HFC-23 decomposition credits</a> were recently observed once again. Despite the long controversy, with arguments for and against going back and forth for over a decade, the market has not moved on from this methodology.</p>
<p>Since April of 2023, almost 30,000 tonnes of credits from an HFC-23 project have been retired in the <a href="https://registry.verra.org/app/search/VCS/VCUs">Verra registry</a>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./recent-hfc23-retirements.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Screenshot of Verra registry retirements of HFC-23 credits</figcaption>
</figure>
</div>
<p>While these credits are from one of the projects which operated in good faith and did not abuse the system to overissue credits, the fact remains that this methodology has been subjected to extensive criticism, and yet no mechanism was deployed by the incumbent VCM participants to exclude the existing credits issued under this methodology from the market - unlike the DCM, which has used public governance to remove these credits from the market.</p>
</section>
<section id="setting-a-floor" class="level1">
<h1>Setting a Floor?</h1>
<p>There is much fanfare over the recent release of the Core Carbon Principles (CCPs) from the Integrity Council for the Voluntary Carbon Market. The hope is that this initiative will establish a clear floor for what defines a “high quality” carbon project. The ICVCM has only <a href="https://twitter.com/ic_vcm/status/1686281235742543872">just begun accepting applications on August 1st, 2023</a> for CCP labeling, with the first labels <a href="https://twitter.com/ic_vcm/status/1686015987269742592">expected to be given out by end of year</a>. It remains to be seen how the implementation of these unobjectionable, broadly accepted principles will be interpreted by the market, and by the media.</p>
<p>But if Murphy’s Law for Methodologies holds, then there will in future be specific issues raised through the normal process of scientific inquiry and consensus forming that undermines the integrity of a particular methodology. And so the CCPs themselves will need a mechanism for evolving over time to reflect that latest scientific consensus, which means they will likely need a mechanism for revoking a CCP label - an analogous problem to methodology deprecation as explored here.</p>
</section>
<section id="the-role-of-public-governance" class="level1">
<h1>The Role of Public Governance</h1>
<p>Unlike the methodology approval or CCP label application process, it is critical that the end-of-life process for methodologies is public. Various stakeholders, from end-users to traders to project developers and carbon experts, must align their incentives through a deliberate governance process to help the market move on. The mud-slinging which has characterized discussions around specific methodologies to date undermines public confidence in the fundamental premise of environmental markets, which doesn’t help any of the market participants, nor does it lead to scalable, high-integrity climate action.</p>
<p>Token-based governance, as used by KlimaDAO’s community to destroy the HFC-23 credits present in the DCM, is by no means perfect. There are a variety of problems to be solved, such as mitigating the role of whales and increasing community engagement, but it does demonstrate what is possible when incentives are aligned.</p>


</section>

</main> <!-- /main -->
<div>

<p><i> All views and opinions expressed here are my own, and do not reflect the official positions of organizations to which I contribute. </i></p>
    
<hr>

<h3> For more like this delivered (infrequently) to your inbox, subscribe: </h3>

<iframe src="https://embeds.beehiiv.com/704193cf-d50a-4fe7-b633-26abf98f0791?slim=true" data-test-id="beehiiv-embed" height="52" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>

<h3> Support my work </h3>
<script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="marcusa" data-color="#3b1f60" data-emoji="🍵" data-font="Cookie" data-text="Buy me a cup of tea" data-outline-color="#ffffff" data-font-color="#ffffff" data-coffee-color="#FFDD00"></script>

<h3> Spread the word </h3>

<a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-hashtags="meditations" data-show-count="false">Tweet</a><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<hr>
</div>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>