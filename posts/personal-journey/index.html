<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marcus Aurelius">
<meta name="dcterms.date" content="2023-03-31">

<title>Marcus Aurelius - The Boy Who Would Be Core</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../pfp.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Marcus Aurelius - The Boy Who Would Be Core">
<meta property="og:description" content="">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Heroesjourney.svg/300px-Heroesjourney.svg.png">
<meta property="og:site-name" content="Marcus Aurelius | Meditations">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Marcus Aurelius</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Meditations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../speaking.html" rel="" target="">
 <span class="menu-text">Speaking</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/0xAurelius" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/0xKlimaurelius" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:marcus_aurelius_0x@proton.me" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">The Boy Who Would Be Core</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">journey</div>
                <div class="quarto-category">klimadao</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Marcus Aurelius </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 31, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://en.wikipedia.org/wiki/Hero%27s_journey"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Heroesjourney.svg/300px-Heroesjourney.svg.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">The Hero‚Äôs Journey</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>‚ÄúOnly those who do not seek power are qualified to hold it.‚Äù - Plato</p>
</blockquote>
<section id="greetings" class="level1">
<h1>Greetings</h1>
<p>As my pseudonym gives away, I‚Äôm a philosopher at heart. I find stoic teachings very relevant given the turbulent times we‚Äôre living through - though I‚Äôd hardly call myself a hardcore capital-S Stoic.</p>
</section>
<section id="impending-doom-great-expectations" class="level1">
<h1>Impending Doom; Great Expectations</h1>
<p>Growing up in Florida, the looming impact of rising sea levels and climate instability on the place where I grew up was evident to me from a young age.</p>
<p>My family always said they expected me to do something great, and I love learning, so school always came easily to me. But I had no idea how I would know what great labor I should take on, and though I thought climate action a worthy candidate, the path forward was not clear.</p>
<p>Later on, in college, I took a class on the Philosphical Problems of Climate Change. That course made it clear to me that ultimately climate change is a coordination game, but that incentives are not aligned for long term climate stability to in our status quo political and economic systems.</p>
<p>In particular, at least in the United States, politicians are only elected for 2-6 year terms - but climate change is a decadal process that requires long-term planning to manage. So for over a decade I felt powerless to contribute to the global coordination problem that is climate change - I‚Äôm too pragmatic for activism like protests and marches, but I‚Äôm not a typical engineer, and many sustainabiltiy companies I had looked at previously were looking for experience I didn‚Äôt have.</p>
</section>
<section id="humble-beginnings-in-academia" class="level1">
<h1>Humble Beginnings in Academia</h1>
<p>My academic background is in astrophysics and philosophy. I had the priveledge of doing research at Santa Fe Institute, where I connected with world-class transdisciplinary thinkers - and also realized the fundamental challenge I would face were I to continue in my academic career. Given the large number of PhDs being minted, and the small number of tenure-track positions available, the odds of success in academia struck me as quite unfavorable. Despite concerted effort to gain research experience during my undergrad to become a desirable PhD applicant, I did not succeed in publishing any papers before I graduated.</p>
<p>From my earliest exposure to philosophy, I‚Äôve been very interested in epistemology - especially philosophy of science. How do scientific communities come to communal understanding of natural phenomena over time? How does that consensus understanding among experts come to be disseminated and integrated into the worldview of ordinary people?</p>
<p>So naturally when I began to pursue academic research of my own, I was drawn to verifying (or rather, in the spirit of Popper, falsifying) prominent theories in a particular niche. However, because I was comparing theoretical predictions with real-world data - and it turns out many theories in niche subfields have not been rigorously checked against data and often don‚Äôt stand up well - both my astro research and my research at SFI resulted in negative results.</p>
<p>My mentors and advisors always told me that negative results were not publishable, which I found immensely frustrating. How would other scientists know that this theory struggles to accurately model real data? Every researcher who tried to use this model to predict the behavior of real systems would find it doesn‚Äôt quite work, but without a paper rigorously documenting the inaccuracies that knowledge would never be integrated into the consensus understanding.</p>
<p>Still discouraged by these early experiences in academia, I‚Äôm keenly interested in the nascent DeSci space, as it may just offer solutions to some of academia‚Äôs problems, such as irreproducibility and gatekeeping by incumbent rent-seekers like journal publishers.</p>
</section>
<section id="learning-to-operate-in-organizations" class="level1">
<h1>Learning to Operate in Organizations</h1>
<p>Since school, I‚Äôve been broadening out into an E-shaped person. Between the programming experience I picked up analyzing telescope images and working with genomic data in my research, combined with the critical thinking and problem solving skills from philosophy, made me very well suited to work in the emerging field of data science. I struggled a bit initially trying to get management consulting jobs with a data focus so I could work across a few different industries, but eventually I found a boutique data-focused consulting firm that would take me on.</p>
<p>Working inside of giant corporations as a consultant was a <em>highly</em> educating experience. While many view corporations as faceless, nameless behemoths that act with a unified heartless will, I rapidly understood how ossified and uncoordinated most corporations are internally, which explains how ordinary people ‚Äújust trying to do their job‚Äù could be complicit in such horrendous decision-making.</p>
<p>After being pushed into management without insufficient resources and only 2 years of experience, it rapidly became clear to me I would not be able to grow and mature surrounded by people less experienced than me and led by men 30 years my senior who had no background in the technical work they were directing us to carry out.</p>
<p>So I left to find a software shop where my nascent data engineering and DevOps skillset would be nurtured and I could grow into a mature individual contributor in a technical organization. While I considered an offer from a crypto firm to lead the team building their infrastructure, this seemed like too much responsibility given my limited experience, so I settled into a mid-level software engineering job at a mid-stage AdTech startup building data pipelines and cloud infrastructure. The systems I built analyzed data from social media platforms to help advertisers make better decisions about what type of content to support with their ad spend, so they could avoid supporting content that might be harmful or damage their brand, as well as target content that would be likely to have viewers from their target audience.</p>
</section>
<section id="leaving-the-ordinary-world-behind" class="level1">
<h1>Leaving the Ordinary World Behind</h1>
<p>Back in 2016 or so I took a Coursera course about Bitcoin and distributed ledger technology, and it mentioned smart contracts briefly for insurance and real estate, but I didn‚Äôt see any of that actually being built at the time. Ethereum had just launched, and while it captured my imagination, it seemed more like a science fair project than a planetary-scale compute and settlement layer - so I remained a crypto-skeptic and moved on (for now).</p>
<p>In late 2020 I started learning more about crypto again at the behest of my neighbor - who had been participating in DeFi Summer. I fell down the rabbit hole, finally seeing real applications use smart contracts for basic financial use-cases like borrowing-and-lending (Aave) or decentralized swaps (Uniswap). I became a regular Bankless listener and started playing around with DeFi applications.</p>
<section id="entering-the-dark-forest" class="level2">
<h2 class="anchored" data-anchor-id="entering-the-dark-forest">Entering the Dark Forest</h2>
<p>It was just another Monday evening watching the <a href="https://www.youtube.com/watch?v=uM5XX4AwEuI">latest Bankless episode on YouTube</a>, but the more I heard the more I realized this was not just another crypto project. The idea of using blockchain technology to bring greater transparency and efficiency to climate finance struck me as a perfect combination of my experience with data and my longstanding desire to contribute my professional skills to support climate action.</p>
<p>Later that night I was pouring over the documentation and Discord, considering whether to put some of my own money at risk to support the project. This is what I‚Äôd been looking for: an opportunity to use my capital and skills to make a difference.</p>
<p>But things were not all sunny in paradise.</p>
<p>In the lead up to launch, there were many concerned and confused Klimates. I was quickly deputized as a moderator for my early work answering questions and helping people troubleshoot issues. The Core Team was busy and pulled in a million directions, so I did my best to keep the Discord under control, building Discord bots for Q/A and common metrics people were constantly asking for.</p>
<p>Launch was the most intense 48 hours of my life. We were on a voice chat for 16 hours straight, squashed bug after bug, and addressed hundreds of individual questions and issues. In the wake of the launch, there were suddenly hundreds of people who wanted to contribute to the DAO - utter chaos ensued, and I found myself called upon to lead.</p>
</section>
<section id="the-call-to-adventure" class="level2">
<h2 class="anchored" data-anchor-id="the-call-to-adventure">The Call to Adventure</h2>
<p>Around November or December, the Core Team first offered me to come aboard as a Core Contributor. At first I rejected the call to adventure, worried about the risk and instability of leaving my comfortable corporate AdTech data engineering gig to run my own company and provide services to a DAO.</p>
<p>But around the end of the year, my previous company got acquired at just the right moment to give me a little cash and a good reason to move on to a new adventure.</p>
</section>
</section>
<section id="documenting-my-journey" class="level1">
<h1>Documenting My Journey</h1>
<p>For the past year or so, my main gig has been Core Contributor at KlimaDAO, where I focus on data, strategy and governance. I‚Äôm also humbled to represent the DAO publicly by speaking at conferences, appearing on podcasts and speaking with media.</p>
<p>It‚Äôs been a joy to develop my public speaking skills sharing about a movement that I‚Äôm so passionate about, and begin my journey as a leader in the space as part of a community that I came up through organically, from a quiet observer in Discord, to a moderator, to building bots and dashboards, and finally stepping up to become a Core contributor.</p>
<p>After having several people ask me to document my journey and share insights I‚Äôve gained along the way, I created this blog to serve as a public journal.</p>
<p>While I will carefully maintain the consistency of which identity is tied to which project, I will use this blog as a place to make observations from my unique perspective as a whole person - which may occassionally blur the line between my personas. More on my thoughts about pseudonymity and identity to come.</p>


</section>

</main> <!-- /main -->
<div>
<hr>

<h3> Stay in touch </h3>

<p> For more insights like this delivered (infrequently) to your inbox, subscribe:
</p>

<iframe src="https://embeds.beehiiv.com/704193cf-d50a-4fe7-b633-26abf98f0791?slim=true" data-test-id="beehiiv-embed" height="52" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>

<h3> Support my work with a cup of tea </h3>

<script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="marcusa" data-color="#3b1f60" data-emoji="üçµ" data-font="Cookie" data-text="Buy me a cup of tea" data-outline-color="#ffffff" data-font-color="#ffffff" data-coffee-color="#FFDD00"></script>

<h3> Spread the word </h3>

<a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-hashtags="#rstats" data-show-count="false">Tweet</a><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<hr>
</div>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>